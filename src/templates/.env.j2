{% raw %}
# {{ ansible_managed }} - Generated by Ansible
# Mailu main configuration file

# This file is templated by Ansible.
# Variables are populated from domain configurations and group variables.

###################################
# Common configuration
###################################

# Set to a randomly generated 16 bytes string
SECRET_KEY={{ lookup('password', '/dev/null chars=ascii_letters,digits length=16') }}

# Main mail domain - this will be the primary domain
DOMAIN={{ primary_domain }}

# Hostnames for this server, separated with comas
HOSTNAMES={% for domain_item in loaded_domains.results %}{% set domain_cfg = domain_item.ansible_facts.domain_config %}{{ domain_cfg.hostname }}{% if not loop.last %},{% endif %}{% endfor %}

# Postmaster local part (will expand to postmaster@domain)
POSTMASTER=postmaster

# Choose how secure connections will behave (value: letsencrypt, cert, notls, mail, mail-letsencrypt)
TLS_FLAVOR=mail

# Authentication rate limit per IP (in seconds)
AUTH_RATELIMIT=10/minute

# Opt-out of statistics collection, replace with "True" to opt out
DISABLE_STATISTICS=False

###################################
# Optional features
###################################

# Expose the admin interface (value: true, false)
ADMIN=true

# Choose which webmail to run if any (values: roundcube, rainloop, none)
WEBMAIL=roundcube

# Dav server implementation (value: radicale, none)
WEBDAV=none

# Antivirus solution (value: clamav, none)
ANTIVIRUS=clamav

###################################
# Mail settings
###################################

# Message size limit in bytes
# Default: accept messages up to 50MB
MESSAGE_SIZE_LIMIT=50000000

# Message rate limit (per user)
MESSAGE_RATELIMIT=100/day

# Networks granted relay permissions, unquoted
RELAYNETS=

# Will relay all outgoing mails if configured
RELAYHOST=

# Fetchmail delay
FETCHMAIL_DELAY=600

# Recipient delimiter (default: +)
RECIPIENT_DELIMITER=+

# DMARC rua and ruf email addresses
DMARC_RUA=postmaster
DMARC_RUF=postmaster

# Welcome email, enable and set a topic and body if needed
WELCOME=false
WELCOME_SUBJECT=
WELCOME_BODY=

# Default quota for new users
QUOTA=1G

# Skip creation of basic aliases (default: none)
# Values: none, sasl, all
SKIP_BASIC_ALIASES=none

# Default password scheme (value: BLF-CRYPT, PBKDF2, SHA512-CRYPT, SHA256-CRYPT)
PASSWORD_SCHEME=PBKDF2

###################################
# Backup configuration
###################################

# Encryption key for backups (AES-256)
BACKUP_ENCRYPTION_KEY={{ lookup('password', '/dev/null chars=ascii_letters,digits length=32') }}

###################################
# Database settings
###################################

# DB_FLAVOR can be sqlite, mysql, postgresql
DB_FLAVOR=sqlite

# Optional database settings
# DB_HOST=
# DB_PORT=
# DB_NAME=
# DB_USER=
# DB_PASSWORD=

###################################
# Traefik integration settings
###################################

# Frontend services will be exposed through Traefik
TRAEFIK_ENABLED=true
TRAEFIK_NETWORK={{ traefik_network_name }}

###################################
# Logging
###################################

# Log level (value: WARNING, INFO, DEBUG, ...)
LOG_LEVEL=INFO

###################################
# Container specific settings
###################################

COMPOSE_PROJECT_NAME=mailu

# Default containers to include (remove if not needed)
COMPOSE_FILE=docker-compose.yml

# These are determined automatically by Traefik/Ansible
SUBNET=192.168.203.0/24
NGINX_EXTERNAL_PORT=443

# Override the following if needed (normally handled by Traefik)
# FRONT_ADDRESS=mailu_front
# FRONT_PORT=80
# WEB_ADMIN=true
# WEB_WEBMAIL=true
{% endraw %}
