{% raw %}
# {{ ansible_managed }} - Generated by Ansible
# CrowdSec acquisition configuration for monitoring Mailu logs

filenames:
  # Traefik logs
  - /var/log/traefik/*.log
  
  # Mailu SMTP logs
  - /var/log/mail/*.log
  - /var/log/mail/mail.log
  - /var/log/mail/mail.err
  
  # Postfix logs
  - /var/log/postfix/*.log
  - /var/log/mail.log
  
  # Dovecot logs
  - /var/log/dovecot.log
  - /var/log/dovecot-*.log
  
  # NGINX logs
  - /var/log/nginx/*.log

# Docker (for container logs)
docker_collection:
  container_name:
    - mailu_front
    - mailu_smtp 
    - mailu_imap
    - traefik

labels:
  type: mailu
  service: mail

---

filenames:
  - /var/log/syslog
  - /var/log/auth.log
  - /var/log/mail.log

labels:
  type: syslog

---

filenames:
  - {{ mailu_base_dir }}/data/logs/dovecot/*.log

labels:
  type: dovecot
  service: dovecot

---

filenames:
  - {{ mailu_base_dir }}/data/logs/postfix/*.log

labels:
  type: postfix
  service: postfix

---

filenames:
  - {{ mailu_base_dir }}/data/logs/nginx/access.log

labels:
  type: nginx
  service: nginx
{% endraw %}