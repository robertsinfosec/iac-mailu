{% raw %}
# {{ ansible_managed }} - Generated by Ansible
# CrowdSec collections configuration for Mailu security

collections:
  # Mail service protections
  - crowdsecurity/postfix
  - crowdsecurity/dovecot
  - crowdsecurity/nginx-modsecurity
  - crowdsecurity/mail-abuse
  
  # System security
  - crowdsecurity/linux
  - crowdsecurity/ssh-bf
  - crowdsecurity/http-bf
  
  # IP reputation and general protections
  - crowdsecurity/blacklists
  - crowdsecurity/iptables

scenarios:
  # Mail service scenarios
  - crowdsecurity/imap-bf
  - crowdsecurity/pop3-bf
  - crowdsecurity/smtp-bf
  - crowdsecurity/smtp-spam
  - crowdsecurity/smtp-auth-bf
  
  # Web interface protection
  - crowdsecurity/http-bad-user-agent
  - crowdsecurity/http-crawl-non_statics
  - crowdsecurity/http-path-traversal-probing
  - crowdsecurity/http-probing
  - crowdsecurity/http-sqli-probing
  
  # System protection
  - crowdsecurity/ssh-bf
  - crowdsecurity/ssh-bf_user-enum

parsers:
  # Mail service parsers
  - crowdsecurity/dovecot-logs
  - crowdsecurity/postfix-logs
  - crowdsecurity/nginx-logs
  
  # System parsers
  - crowdsecurity/syslog-logs
  - crowdsecurity/dateparse-enrich

postoverflows:
  - crowdsecurity/seo-bots-whitelist
  - crowdsecurity/cdn-whitelist
  - crowdsecurity/whitelist-good-actors

decisions:
  # Duration to ban for different scenarios
  - type: ban
    duration: 4h  # Default ban time
    on:
      - crowdsecurity/ssh-bf
      - crowdsecurity/http-bf
  
  - type: ban
    duration: 24h  # Longer ban for mail abuse
    on:
      - crowdsecurity/smtp-bf
      - crowdsecurity/smtp-spam
      - crowdsecurity/imap-bf
{% endraw %}